{"version":3,"file":"files_downloadlimit-admin.mjs","sources":["../node_modules/@nextcloud/vue/dist/chunks/NcSettingsSection-BzN6JXnV.mjs","../src/services/AdminService.ts","../src/views/AdminSettings.vue","../src/admin.ts"],"sourcesContent":["import '../assets/NcSettingsSection-8RabR54v.css';\nimport { r, p as a, a as l } from \"./_l10n-Cj65IvRp.mjs\";\nimport { n as s } from \"./_plugin-vue2_normalizer-Bj5bLKV4.mjs\";\nr(a);\nconst c = {\n  name: \"HelpCircleIcon\",\n  emits: [\"click\"],\n  props: {\n    title: {\n      type: String\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n};\nvar o = function() {\n  var t = this, e = t._self._c;\n  return e(\"span\", t._b({ staticClass: \"material-design-icon help-circle-icon\", attrs: { \"aria-hidden\": t.title ? null : !0, \"aria-label\": t.title, role: \"img\" }, on: { click: function(n) {\n    return t.$emit(\"click\", n);\n  } } }, \"span\", t.$attrs, !1), [e(\"svg\", { staticClass: \"material-design-icon__svg\", attrs: { fill: t.fillColor, width: t.size, height: t.size, viewBox: \"0 0 24 24\" } }, [e(\"path\", { attrs: { d: \"M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z\" } }, [t.title ? e(\"title\", [t._v(t._s(t.title))]) : t._e()])])]);\n}, _ = [], d = /* @__PURE__ */ s(\n  c,\n  o,\n  _,\n  !1,\n  null,\n  null,\n  null,\n  null\n);\nconst m = d.exports, p = {\n  name: \"NcSettingsSection\",\n  components: {\n    HelpCircle: m\n  },\n  props: {\n    name: {\n      type: String,\n      required: !0\n    },\n    description: {\n      type: String,\n      default: \"\"\n    },\n    docUrl: {\n      type: String,\n      default: \"\"\n    },\n    /**\n     * Limit the width of the setting's content\n     *\n     * By default only the name and description have a limit, use this\n     * property to also apply this to the rest of the content.\n     */\n    limitWidth: {\n      type: Boolean,\n      default: !0\n    }\n  },\n  data() {\n    return {\n      docNameTranslated: l(\"External documentation for {name}\", {\n        name: this.name\n      })\n    };\n  },\n  computed: {\n    hasDescription() {\n      return this.description.length > 0;\n    },\n    hasDocUrl() {\n      return this.docUrl.length > 0;\n    }\n  }\n};\nvar f = function() {\n  var t = this, e = t._self._c;\n  return e(\"div\", { staticClass: \"settings-section\", class: { \"settings-section--limit-width\": t.limitWidth } }, [e(\"h2\", { staticClass: \"settings-section__name\" }, [t._v(\" \" + t._s(t.name) + \" \"), t.hasDocUrl ? e(\"a\", { staticClass: \"settings-section__info\", attrs: { href: t.docUrl, title: t.docNameTranslated, \"aria-label\": t.docNameTranslated, target: \"_blank\", rel: \"noreferrer nofollow\" } }, [e(\"HelpCircle\", { attrs: { size: 20 } })], 1) : t._e()]), t.hasDescription ? e(\"p\", { staticClass: \"settings-section__desc\" }, [t._v(\" \" + t._s(t.description) + \" \")]) : t._e(), t._t(\"default\")], 2);\n}, u = [], g = /* @__PURE__ */ s(\n  p,\n  f,\n  u,\n  !1,\n  null,\n  \"f51cf2d3\",\n  null,\n  null\n);\nconst v = g.exports;\nexport {\n  v as N\n};\n","/**\n * @copyright 2024 Christopher Ng <chrng8@gmail.com>\n *\n * @author Christopher Ng <chrng8@gmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport axios from '@nextcloud/axios'\nimport { generateOcsUrl } from '@nextcloud/router'\n\nexport const setDefaultLimit = async (limit: number): Promise<[]> => {\n\tconst response = await axios.put(generateOcsUrl('/apps/files_downloadlimit/api/v1/limit'), {\n\t\tlimit,\n\t})\n\treturn response.data.ocs.data\n}\n","<!--\n  - @copyright 2024 Christopher Ng <chrng8@gmail.com>\n  -\n  - @author Christopher Ng <chrng8@gmail.com>\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n-->\n\n<template>\n\t<NcSettingsSection :name=\"t('files_downloadlimit', 'Download limit')\"\n\t\t:description=\"t('files_downloadlimit', 'Configure the default download limit for external shares.')\">\n\t\t<form @submit.prevent=\"handleSave\">\n\t\t\t<NcTextField class=\"settings__field\"\n\t\t\t\t:label=\"t('files_downloadlimit', 'Set default download limit')\"\n\t\t\t\ttype=\"number\"\n\t\t\t\tmin=\"1\"\n\t\t\t\t:value=\"limit\"\n\t\t\t\t:helper-text=\"helperText\"\n\t\t\t\t:error=\"Boolean(helperText)\"\n\t\t\t\t:success=\"showSuccess\"\n\t\t\t\t:show-trailing-button=\"showTrailingButton\"\n\t\t\t\ttrailing-button-icon=\"arrowRight\"\n\t\t\t\t@update:value=\"handleUpdateLimit\"\n\t\t\t\t@trailing-button-click=\"handleSave\" />\n\t\t</form>\n\t</NcSettingsSection>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport { loadState } from '@nextcloud/initial-state'\nimport { translate as t } from '@nextcloud/l10n'\nimport { showError } from '@nextcloud/dialogs'\n\nimport NcSettingsSection from '@nextcloud/vue/dist/Components/NcSettingsSection.js'\nimport NcTextField from '@nextcloud/vue/dist/Components/NcTextField.js'\n\nimport { setDefaultLimit } from '../services/AdminService.ts'\n\nconst defaultDownloadLimit = loadState<number>('files_downloadlimit', 'default-download-limit', -1)\n// If a default is not set (-1) then the input should be empty\nconst limit: '' | number = defaultDownloadLimit === -1 ? '' : defaultDownloadLimit\n\nexport default defineComponent({\n\tname: 'AdminSettings',\n\n\tcomponents: {\n\t\tNcSettingsSection,\n\t\tNcTextField,\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tlimit,\n\t\t\tsavedLimit: limit,\n\t\t\tshowSuccess: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\thelperText() {\n\t\t\tif (typeof this.limit !== 'number') {\n\t\t\t\treturn ''\n\t\t\t}\n\t\t\tif (this.limit > 0) {\n\t\t\t\treturn ''\n\t\t\t}\n\t\t\treturn t('files_downloadlimit', 'The minimum limit is 1')\n\t\t},\n\n\t\tshowTrailingButton() {\n\t\t\treturn typeof this.limit === 'number'\n\t\t\t\t&& this.limit > 0\n\t\t\t\t&& this.limit !== this.savedLimit\n\t\t},\n\t},\n\n\tmethods: {\n\t\tt,\n\n\t\thandleUpdateLimit(limit: string) {\n\t\t\tthis.limit = Number(limit) // emitted <input> value is string so we parse it to number\n\t\t},\n\n\t\tasync handleSave() {\n\t\t\tconst isValid = typeof this.limit === 'number' && this.limit > 0\n\t\t\tif (!isValid) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tawait setDefaultLimit(this.limit)\n\t\t\t\tthis.savedLimit = this.limit\n\t\t\t\tthis.showSuccess = true\n\t\t\t\tsetTimeout(() => { this.showSuccess = false }, 3000)\n\t\t\t} catch (error) {\n\t\t\t\tshowError(t('files_downloadlimit', 'Failed to set default download limit'))\n\t\t\t}\n\t\t},\n\t},\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.settings {\n\t&__field {\n\t\tmax-width: 500px;\n\t}\n}\n</style>\n","/**\n * @copyright 2024 Christopher Ng <chrng8@gmail.com>\n *\n * @author Christopher Ng <chrng8@gmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport Vue from 'vue'\n\nimport AdminSettings from './views/AdminSettings.vue'\n\nnew Vue({\n\tel: '#admin-download-limit',\n\trender: h => h(AdminSettings),\n})\n"],"names":["r","a","c","o","e","n","_","d","s","m","p","l","f","u","g","v","setDefaultLimit","limit","axios","generateOcsUrl","defaultDownloadLimit","loadState","_sfc_main","defineComponent","NcSettingsSection","NcTextField","t","showError","Vue","h","AdminSettings"],"mappings":"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","x_google_ignoreList":[0]}